<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:engine2="clr-namespace:BudgetAnalyser.Engine;assembly=BudgetAnalyser.Engine"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:budget="clr-namespace:BudgetAnalyser.Budget"
                    xmlns:converters="clr-namespace:BudgetAnalyser.Converters">

    <converters:BudgetBucketToStringConverter x:Key="BudgetBucketToStringConverter" />

    <DataTemplate x:Key="TransactionTemplate1"
                  DataType="engine2:Transaction">
        <Border x:Name="MainBorder"
                Margin="0,1,2,1">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="30" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition SharedSizeGroup="A"
                                      Width="Auto" />
                    <ColumnDefinition SharedSizeGroup="B"
                                      Width="Auto" />
                    <ColumnDefinition SharedSizeGroup="C"
                                      Width="Auto" />
                    <ColumnDefinition SharedSizeGroup="D"
                                      Width="Auto" />
                    <ColumnDefinition SharedSizeGroup="E"
                                      Width="Auto" />
                    <ColumnDefinition SharedSizeGroup="F"
                                      Width="Auto" />
                    <ColumnDefinition SharedSizeGroup="G"
                                      Width="Auto" />
                    <ColumnDefinition SharedSizeGroup="H"
                                      Width="Auto" />
                    <ColumnDefinition SharedSizeGroup="I"
                                      Width="Auto" />
                </Grid.ColumnDefinitions>
                <TextBlock HorizontalAlignment="Left"
                           Text="{Binding Date, StringFormat=\{0:d\}}"
                           TextTrimming="CharacterEllipsis"
                           TextWrapping="NoWrap"
                           ToolTip="{Binding Date, StringFormat=\{0:D\}}"
                           VerticalAlignment="Top" />
                <TextBlock Grid.Column="1"
                           Style="{StaticResource TextBlockNumber}"
                           Text="{Binding Amount, StringFormat=\{0:N\}}" />
                <TextBlock Grid.Column="2"
                           HorizontalAlignment="Left"
                           Text="{Binding Description}"
                           TextTrimming="CharacterEllipsis"
                           TextWrapping="NoWrap"
                           ToolTip="{Binding Description}"
                           VerticalAlignment="Top" />
                <TextBlock Grid.Column="3"
                           HorizontalAlignment="Left"
                           MinWidth="120"
                           Text="{Binding BudgetBucket, Converter={StaticResource BudgetBucketToStringConverter}}"
                           TextTrimming="CharacterEllipsis"
                           TextWrapping="NoWrap"
                           ToolTip="{Binding BudgetBucket}"
                           VerticalAlignment="Top" />
                <TextBlock Grid.Column="4"
                           HorizontalAlignment="Left"
                           Text="{Binding Reference1}"
                           TextTrimming="CharacterEllipsis"
                           TextWrapping="NoWrap"
                           ToolTip="{Binding Reference1}"
                           VerticalAlignment="Top" />
                <TextBlock Grid.Column="5"
                           HorizontalAlignment="Left"
                           Text="{Binding Reference2}"
                           TextTrimming="CharacterEllipsis"
                           TextWrapping="NoWrap"
                           ToolTip="{Binding Reference2}"
                           VerticalAlignment="Top" />
                <TextBlock Grid.Column="6"
                           HorizontalAlignment="Left"
                           Text="{Binding Reference3}"
                           TextTrimming="CharacterEllipsis"
                           TextWrapping="NoWrap"
                           ToolTip="{Binding Reference3}"
                           VerticalAlignment="Top" />
                <TextBlock Grid.Column="7"
                           HorizontalAlignment="Left"
                           Text="{Binding TransactionType}"
                           TextTrimming="CharacterEllipsis"
                           TextWrapping="NoWrap"
                           ToolTip="{Binding TransactionType}"
                           VerticalAlignment="Top" />
                <Image Grid.Column="8"
                       Height="20"
                       HorizontalAlignment="Left"
                       Margin="4"
                       Source="{Binding AccountType.ImagePath}"
                       Stretch="Uniform"
                       ToolTip="{Binding AccountType.Name}"
                       VerticalAlignment="Top"
                       Width="62" />
            </Grid>
        </Border>
        <DataTemplate.Triggers>
            <DataTrigger Value="True">
                <DataTrigger.Binding>
                    <Binding Path="IsSuspectedDuplicate" />
                </DataTrigger.Binding>
                <DataTrigger.Setters>
                    <Setter Property="Background"
                            TargetName="MainBorder"
                            Value="{StaticResource ImportantHighlightLightBrush}" />
                </DataTrigger.Setters>
            </DataTrigger>
        </DataTemplate.Triggers>
    </DataTemplate>


    <DataTemplate x:Key="TransactionEditTemplate1"
                  DataType="engine2:Transaction">
        <Border x:Name="MainBorder"
                Margin="0,1,2,1">
            <Grid FocusManager.FocusedElement="{Binding ElementName=BucketCodeComboBox}"
                  Height="28">
                <Grid.RowDefinitions>
                    <RowDefinition Height="35" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition SharedSizeGroup="A"
                                      Width="Auto" />
                    <ColumnDefinition SharedSizeGroup="B"
                                      Width="Auto" />
                    <ColumnDefinition SharedSizeGroup="C"
                                      Width="Auto" />
                    <ColumnDefinition SharedSizeGroup="D"
                                      Width="Auto" />
                    <ColumnDefinition SharedSizeGroup="E"
                                      Width="Auto" />
                    <ColumnDefinition SharedSizeGroup="F"
                                      Width="Auto" />
                    <ColumnDefinition SharedSizeGroup="G"
                                      Width="Auto" />
                    <ColumnDefinition SharedSizeGroup="H"
                                      Width="Auto" />
                    <ColumnDefinition SharedSizeGroup="I"
                                      Width="Auto" />
                </Grid.ColumnDefinitions>
                <DatePicker CalendarStyle="{StaticResource CalendarStyle}"
                            HorizontalAlignment="Left"
                            SelectedDate="{Binding Date}"
                            VerticalAlignment="Top"
                            Width="34"
                            TabIndex="2" />
                <TextBlock Grid.Column="1"
                           HorizontalAlignment="Right"
                           Text="{Binding Amount, StringFormat=\{0:N\}}"
                           TextTrimming="CharacterEllipsis"
                           TextWrapping="NoWrap"
                           VerticalAlignment="Top" />
                <TextBox Grid.Column="2"
                         HorizontalAlignment="Left"
                         Text="{Binding Description}"
                         ToolTip="{Binding Description}"
                         TabIndex="3"
                         VerticalAlignment="Top" />
                <ComboBox x:Name="BucketCodeComboBox"
                          DisplayMemberPath="Code"
                          Grid.Column="3"
                          HorizontalAlignment="Left"
                          ItemContainerStyle="{StaticResource BudgetBucketComboItemStyle}"
                          ItemsSource="{Binding Source={x:Static budget:BudgetBucketBindingSource.BucketRepository}, Path=Buckets}"
                          MinWidth="120"
                          SelectedItem="{Binding BudgetBucket}"
                          TabIndex="1"
                          ToolTip="{Binding BudgetBucket}"
                          VerticalAlignment="Top" />
                <TextBox Grid.Column="4"
                         HorizontalAlignment="Left"
                         Text="{Binding Reference1}"
                         ToolTip="{Binding Reference1}"
                         TabIndex="4"
                         VerticalAlignment="Top" />
                <TextBox Grid.Column="5"
                         HorizontalAlignment="Left"
                         Text="{Binding Reference2}"
                         ToolTip="{Binding Reference2}"
                         TabIndex="5"
                         VerticalAlignment="Top" />
                <TextBox Grid.Column="6"
                         HorizontalAlignment="Left"
                         Text="{Binding Reference3}"
                         ToolTip="{Binding Reference3}"
                         TabIndex="6"
                         VerticalAlignment="Top" />
                <TextBlock Grid.Column="7"
                           HorizontalAlignment="Left"
                           Text="{Binding TransactionType}"
                           TextTrimming="CharacterEllipsis"
                           TextWrapping="NoWrap"
                           ToolTip="{Binding TransactionType}"
                           VerticalAlignment="Top" />
                <Image Grid.Column="8"
                       Height="20"
                       HorizontalAlignment="Left"
                       Margin="4"
                       Source="{Binding AccountType.ImagePath}"
                       Stretch="Uniform"
                       ToolTip="{Binding AccountType.Name}"
                       VerticalAlignment="Top"
                       Width="62" />
            </Grid>
        </Border>
    </DataTemplate>


    <Style x:Key="TransactionListBoxContainer"
           TargetType="ListBoxItem">
        <Setter Property="SnapsToDevicePixels"
                Value="true" />
        <Setter Property="ContentTemplate"
                Value="{StaticResource TransactionTemplate1}" />
        <Setter Property="Template">
            <Setter.Value>

                <ControlTemplate TargetType="ListBoxItem">
                    <Border x:Name="Border"
                            Margin="0,2,2,2"
                            SnapsToDevicePixels="true">
                        <ContentPresenter />
                    </Border>
                    <ControlTemplate.Triggers>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver"
                                           Value="True" />
                                <Condition Property="IsSelected"
                                           Value="False" />
                            </MultiTrigger.Conditions>
                            <MultiTrigger.Setters>
                                <Setter Property="Background"
                                        TargetName="Border"
                                        Value="{StaticResource ControlMouseOverBrush}" />
                            </MultiTrigger.Setters>
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver"
                                           Value="False" />
                                <Condition Property="IsSelected"
                                           Value="True" />
                            </MultiTrigger.Conditions>
                            <MultiTrigger.Setters>
                                <Setter Property="Background"
                                        TargetName="Border"
                                        Value="{StaticResource SelectedItemRowBrush}" />
                            </MultiTrigger.Setters>
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver"
                                           Value="True" />
                                <Condition Property="IsSelected"
                                           Value="True" />
                            </MultiTrigger.Conditions>
                            <MultiTrigger.Setters>
                                <Setter Property="Background"
                                        TargetName="Border"
                                        Value="{StaticResource SelectedItemRowBrush}" />
                            </MultiTrigger.Setters>
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver"
                                           Value="False" />
                                <Condition Property="IsSelected"
                                           Value="False" />
                                <Condition Property="ItemsControl.AlternationIndex"
                                           Value="0" />
                            </MultiTrigger.Conditions>
                            <MultiTrigger.Setters>
                                <Setter Property="Background"
                                        TargetName="Border"
                                        Value="{StaticResource TileBackgroundBrush}" />
                            </MultiTrigger.Setters>
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver"
                                           Value="False" />
                                <Condition Property="IsSelected"
                                           Value="False" />
                                <Condition Property="ItemsControl.AlternationIndex"
                                           Value="1" />
                            </MultiTrigger.Conditions>
                            <MultiTrigger.Setters>
                                <Setter Property="Background"
                                        TargetName="Border"
                                        Value="{StaticResource TileBackgroundAlternateBrush}" />
                            </MultiTrigger.Setters>
                        </MultiTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="Tag"
                     Value="True">
                <Setter Property="ContentTemplate"
                        Value="{StaticResource TransactionEditTemplate1}" />
            </Trigger>
        </Style.Triggers>
    </Style>

</ResourceDictionary>
